# MDTopic é¡¹ç›®ç»“æ„è¯´æ˜

## ğŸ“ é¡¹ç›®ç›®å½•ç»“æ„

```
mdtopic/
â”œâ”€â”€ README.md                   # é¡¹ç›®ä¸»æ–‡æ¡£
â”œâ”€â”€ package.json                # é¡¹ç›®é…ç½®å’Œä¾èµ–
â”œâ”€â”€ index.js                    # CLIå·¥å…·å…¥å£ (å¯æ‰§è¡Œæ–‡ä»¶)
â”œâ”€â”€ 
â”œâ”€â”€ lib/                        # æ ¸å¿ƒåº“
â”‚   â””â”€â”€ markdown-converter.js   # Markdownè½¬æ¢æ ¸å¿ƒé€»è¾‘
â”œâ”€â”€ 
â”œâ”€â”€ scripts/                    # éƒ¨ç½²å’Œç®¡ç†è„šæœ¬
â”‚   â”œâ”€â”€ README.md              # è„šæœ¬è¯´æ˜æ–‡æ¡£
â”‚   â”œâ”€â”€ install-all.sh         # ä¸€é”®å®‰è£…è„šæœ¬
â”‚   â””â”€â”€ manage-service.sh      # æœåŠ¡ç®¡ç†è„šæœ¬
â”œâ”€â”€ 
â”œâ”€â”€ src/                        # æºä»£ç 
â”‚   â”œâ”€â”€ config/                 # é…ç½®æ¨¡å—
â”‚   â”‚   â”œâ”€â”€ config.js          # ä¸»é…ç½®æ–‡ä»¶
â”‚   â”‚   â””â”€â”€ css-styles.js      # CSSæ ·å¼æ„å»ºå™¨
â”‚   â”œâ”€â”€ server/                # åç«¯æœåŠ¡
â”‚   â”‚   â””â”€â”€ server.js          # ExpressæœåŠ¡å™¨
â”‚   â””â”€â”€ web/                   # å‰ç«¯ä»£ç 
â”‚       â”œâ”€â”€ App.jsx            # Reactä¸»ç»„ä»¶
â”‚       â”œâ”€â”€ App.css            # å‰ç«¯æ ·å¼
â”‚       â”œâ”€â”€ main.jsx           # Reactå…¥å£
â”‚       â”œâ”€â”€ index.html         # HTMLæ¨¡æ¿
â”‚       â”œâ”€â”€ vite.config.js     # Viteé…ç½®
â”‚       â””â”€â”€ package.json       # å‰ç«¯åŒ…é…ç½®
â”œâ”€â”€ 
â”œâ”€â”€ docker/                    # Dockeréƒ¨ç½²
â”‚   â”œâ”€â”€ Dockerfile            # Dockeré•œåƒé…ç½®
â”‚   â”œâ”€â”€ docker-compose.yml    # Docker Composeé…ç½®
â”‚   â””â”€â”€ start.sh              # å¿«é€Ÿå¯åŠ¨è„šæœ¬
â”œâ”€â”€ 
â”œâ”€â”€ dist/                     # å‰ç«¯æ„å»ºäº§ç‰©
â”‚   â”œâ”€â”€ index.html            # æ„å»ºåçš„HTML
â”‚   â””â”€â”€ assets/               # é™æ€èµ„æº
â”œâ”€â”€ 
â”œâ”€â”€ test/                     # æµ‹è¯•æ–‡ä»¶
â”‚   â”œâ”€â”€ test-integration.md   # æµ‹è¯•ç”¨ä¾‹
â”‚   â”œâ”€â”€ test-integration.png  # æµ‹è¯•æœŸæœ›è¾“å‡º
â”‚   â””â”€â”€ test-integration-dark.png # æš—è‰²ä¸»é¢˜æµ‹è¯•
â”œâ”€â”€ 
â”œâ”€â”€ docs/                     # é¡¹ç›®æ–‡æ¡£
â”‚   â”œâ”€â”€ INSTALLATION.md       # å®‰è£…æŒ‡å—
â”‚   â”œâ”€â”€ PROJECT_STRUCTURE.md  # æœ¬æ–‡æ¡£
â”‚   â”œâ”€â”€ API_REFERENCE.md      # APIå‚è€ƒ
â”‚   â”œâ”€â”€ DEPLOYMENT.md         # éƒ¨ç½²æŒ‡å—
â”‚   â””â”€â”€ DEVELOPMENT.md        # å¼€å‘æŒ‡å—
â””â”€â”€ 
```

## ğŸ”§ æ ¸å¿ƒç»„ä»¶è¯´æ˜

### 1. CLI å·¥å…· (`index.js`)
**å…¥å£æ–‡ä»¶**ï¼Œæä¾›å‘½ä»¤è¡Œæ¥å£ï¼š
- æ”¯æŒå•æ–‡ä»¶å’Œæ‰¹é‡è½¬æ¢
- å¤šç§è¾“å‡ºæ ¼å¼ (PNG, JPEG, WebP)
- æ™ºèƒ½ä¼˜åŒ–å’Œé¢„è®¾æ¨¡å¼
- å¯å…¨å±€å®‰è£…ä½¿ç”¨

### 2. æ ¸å¿ƒè½¬æ¢åº“ (`lib/markdown-converter.js`)
**æ ¸å¿ƒè½¬æ¢å¼•æ“**ï¼Œè´Ÿè´£ï¼š
- Markdown è§£æå’Œ HTML æ¸²æŸ“
- Puppeteer æµè§ˆå™¨æ§åˆ¶
- å›¾ç‰‡ç”Ÿæˆå’Œä¼˜åŒ–
- æ ·å¼åº”ç”¨å’Œå­—ä½“å¤„ç†

### 3. Web æœåŠ¡å™¨ (`src/server/server.js`)
**Express.js åç«¯æœåŠ¡**ï¼Œæä¾›ï¼š
- RESTful API æ¥å£
- é™æ€æ–‡ä»¶æœåŠ¡
- é”™è¯¯å¤„ç†å’Œæ—¥å¿—
- å¥åº·æ£€æŸ¥æ¥å£

### 4. å‰ç«¯åº”ç”¨ (`src/web/`)
**React + Vite å‰ç«¯**ï¼ŒåŒ…å«ï¼š
- å®æ—¶ Markdown ç¼–è¾‘å™¨
- å³æ—¶é¢„è§ˆåŠŸèƒ½
- å‚æ•°é…ç½®ç•Œé¢
- æ–‡ä»¶ä¸‹è½½åŠŸèƒ½

### 5. é…ç½®æ¨¡å— (`src/config/`)
**ç³»ç»Ÿé…ç½®ç®¡ç†**ï¼š
- `config.js`: ä¸»è¦é…ç½®å‚æ•°
- `css-styles.js`: CSS æ ·å¼ç”Ÿæˆå™¨

### 6. éƒ¨ç½²è„šæœ¬ (`scripts/`)
**è‡ªåŠ¨åŒ–éƒ¨ç½²å·¥å…·**ï¼š
- `install-all.sh`: ä¸€é”®å®‰è£…è„šæœ¬
- `manage-service.sh`: æœåŠ¡ç®¡ç†è„šæœ¬

## ğŸ—ï¸ æŠ€æœ¯æ¶æ„

### å‰ç«¯æŠ€æœ¯æ ˆ
- **React 18**: ç”¨æˆ·ç•Œé¢æ¡†æ¶
- **Vite**: æ„å»ºå·¥å…·å’Œå¼€å‘æœåŠ¡å™¨
- **CSS3**: æ ·å¼å’Œå¸ƒå±€
- **Fetch API**: HTTP å®¢æˆ·ç«¯

### åç«¯æŠ€æœ¯æ ˆ
- **Node.js**: è¿è¡Œæ—¶ç¯å¢ƒ
- **Express.js**: Web æ¡†æ¶
- **Puppeteer**: æµè§ˆå™¨è‡ªåŠ¨åŒ–
- **Markdown-it**: Markdown è§£æå™¨

### éƒ¨ç½²æŠ€æœ¯
- **Docker**: å®¹å™¨åŒ–éƒ¨ç½²
- **Docker Compose**: å®¹å™¨ç¼–æ’
- **Bash Scripts**: è‡ªåŠ¨åŒ–è„šæœ¬
- **Systemd**: æœåŠ¡ç®¡ç† (å¯é€‰)

## ğŸ“Š æ•°æ®æµ

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   CLI/Web   â”‚â”€â”€â”€â–¶â”‚   Express   â”‚â”€â”€â”€â–¶â”‚  Converter  â”‚
â”‚   Interface â”‚    â”‚   Server    â”‚    â”‚   Library   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                             â”‚
                                             â–¼
                                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                                    â”‚  Puppeteer  â”‚
                                    â”‚   Browser   â”‚
                                    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                             â”‚
                                             â–¼
                                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                                    â”‚    Image    â”‚
                                    â”‚   Output    â”‚
                                    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

1. **è¾“å…¥**: Markdown æ–‡æœ¬ + é…ç½®å‚æ•°
2. **è§£æ**: Markdown-it è§£æä¸º HTML
3. **æ¸²æŸ“**: Puppeteer æµè§ˆå™¨æ¸²æŸ“
4. **ç”Ÿæˆ**: æˆªå›¾å¹¶ä¼˜åŒ–ä¸ºå›¾ç‰‡
5. **è¾“å‡º**: è¿”å›å›¾ç‰‡æ•°æ®

## ğŸ”„ å¼€å‘å·¥ä½œæµ

### æœ¬åœ°å¼€å‘
```bash
# 1. å®‰è£…ä¾èµ–
npm install

# 2. å¯åŠ¨å‰ç«¯å¼€å‘æœåŠ¡å™¨
npm run dev

# 3. å¯åŠ¨åç«¯æœåŠ¡å™¨
npm start

# 4. æ„å»ºç”Ÿäº§ç‰ˆæœ¬
npm run build
```

### Docker å¼€å‘
```bash
# æ„å»ºé•œåƒ
docker compose build

# å¯åŠ¨æœåŠ¡
docker compose up -d

# æŸ¥çœ‹æ—¥å¿—
docker compose logs -f
```

## ğŸ“ é…ç½®æ–‡ä»¶è¯´æ˜

### `package.json`
```json
{
  "name": "mdtopic",
  "main": "lib/markdown-converter.js",
  "bin": {
    "mdtopic": "./index.js"
  },
  "scripts": {
    "start": "node src/server/server.js",
    "dev": "cd src/web && vite",
    "build": "cd src/web && vite build"
  }
}
```

### `docker-compose.yml`
```yaml
services:
  mdtopic:
    build: .
    ports:
      - "3000:3000"
    restart: unless-stopped
```

## ğŸ” å…³é”®æ–‡ä»¶è¯¦è§£

### `lib/markdown-converter.js`
æ ¸å¿ƒè½¬æ¢é€»è¾‘ï¼ŒåŒ…å«ï¼š
- `convertMarkdownToImage()`: ä¸»è½¬æ¢å‡½æ•°
- `convertMarkdownFileToImage()`: æ–‡ä»¶è½¬æ¢
- `convertMarkdownToBase64()`: Base64 è¾“å‡º
- æ ·å¼åº”ç”¨å’Œä¼˜åŒ–ç®—æ³•

### `src/server/server.js`
Web æœåŠ¡å™¨ï¼Œæä¾›ï¼š
- `POST /api/convert`: è½¬æ¢æ¥å£
- `GET /api/options`: é…ç½®é€‰é¡¹
- `GET /api/health`: å¥åº·æ£€æŸ¥
- é™æ€æ–‡ä»¶æœåŠ¡

### `src/web/App.jsx`
å‰ç«¯ä¸»ç»„ä»¶ï¼ŒåŒ…å«ï¼š
- Markdown ç¼–è¾‘å™¨
- å®æ—¶é¢„è§ˆ
- å‚æ•°é…ç½®
- æ–‡ä»¶ä¸‹è½½

## ğŸš€ æ‰©å±•æŒ‡å—

### æ·»åŠ æ–°çš„è¾“å‡ºæ ¼å¼
1. ä¿®æ”¹ `lib/markdown-converter.js`
2. æ›´æ–° `src/server/server.js` API
3. æ·»åŠ å‰ç«¯é…ç½®é€‰é¡¹

### æ·»åŠ æ–°çš„æ ·å¼ä¸»é¢˜
1. åœ¨ `src/config/css-styles.js` æ·»åŠ æ ·å¼
2. æ›´æ–°é…ç½®é€‰é¡¹
3. æ·»åŠ å‰ç«¯ä¸»é¢˜é€‰æ‹©å™¨

### é›†æˆæ–°çš„æ¸²æŸ“å¼•æ“
1. åœ¨ `lib/` ç›®å½•åˆ›å»ºæ–°æ¨¡å—
2. å®ç°æ ‡å‡†æ¥å£
3. æ›´æ–°ä¸»è½¬æ¢å™¨è°ƒç”¨

## ğŸ“š ç›¸å…³æ–‡æ¡£

- [å®‰è£…æŒ‡å—](INSTALLATION.md) - è¯¦ç»†å®‰è£…è¯´æ˜
- [API å‚è€ƒ](API_REFERENCE.md) - æ¥å£æ–‡æ¡£
- [éƒ¨ç½²æŒ‡å—](DEPLOYMENT.md) - ç”Ÿäº§éƒ¨ç½²
- [å¼€å‘æŒ‡å—](DEVELOPMENT.md) - å¼€å‘ç¯å¢ƒ